{
  "active": false,
  "connections": {
    "å­æµç¨‹å…¥å£": {
      "main": [
        [
          {
            "node": "æœºå™¨äººå…³é”®è¯å¤„ç†",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "é’‰é’‰æœºå™¨äºº-text",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "é’‰é’‰æœºå™¨äºº-markdown",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "é’‰é’‰æœºå™¨äºº-text": {
      "main": [
        []
      ]
    },
    "æœºå™¨äººå…³é”®è¯å¤„ç†": {
      "main": [
        [
          {
            "node": "åˆ¤æ–­sessionWebhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "åˆ¤æ–­sessionWebhook": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "é’‰é’‰webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-06-27T04:05:59.471Z",
  "id": "4tHTAEVO9ryUxOhn",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "sub-é’‰é’‰é€šçŸ¥",
  "nodes": [
    {
      "parameters": {
        "inputSource": "jsonExample",
        "jsonExample": "  {\n    \"msgtype\": \"text\",\n    \"sessionWebhook\":\"robot/sendBySession\",\n    \"content\": \"content\",\n    \"title\": \"title\",\n    \"name\": \"åç§°\",\n    \"state\": \"æˆåŠŸ\"\n  }"
      },
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "typeVersion": 1.1,
      "position": [
        -416,
        128
      ],
      "id": "de4e7850-1148-4e14-9f43-9c36a39676f4",
      "name": "å­æµç¨‹å…¥å£",
      "notesInFlow": false
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.msgtype }}",
                    "rightValue": "text",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "cccd874a-f90c-459a-986c-e0eb7b7c0e72"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "8c3c18ff-32d9-4ddf-87b0-4e29cf5b5fe5",
                    "leftValue": "={{ $json.msgtype }}",
                    "rightValue": "markdown",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        256,
        32
      ],
      "id": "271e64cd-5b22-4a74-ac8d-dffc9f69fc08",
      "name": "Switch"
    },
    {
      "parameters": {
        "msgtype": "markdown",
        "title": "={{ $json.title }}",
        "markdownText": "={{ $json.content }}"
      },
      "type": "n8n-nodes-dingtalk.dingTalkRobot",
      "typeVersion": 1,
      "position": [
        480,
        128
      ],
      "id": "9b298538-2d9a-495e-ac61-0bf649edd318",
      "name": "é’‰é’‰æœºå™¨äºº-markdown",
      "credentials": {
        "dingTalkCustomRobotApi": {
          "id": "ewEy0mraYFqwnuN2",
          "name": "DingTalk - Automation"
        }
      }
    },
    {
      "parameters": {
        "content": "={{ $json.content }}"
      },
      "type": "n8n-nodes-dingtalk.dingTalkRobot",
      "typeVersion": 1,
      "position": [
        480,
        -64
      ],
      "id": "052364b9-7d67-4be4-b4b7-00f81619fc14",
      "name": "é’‰é’‰æœºå™¨äºº-text",
      "credentials": {
        "dingTalkCustomRobotApi": {
          "id": "ewEy0mraYFqwnuN2",
          "name": "DingTalk - Automation"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "return $input.all().map(item => {\n  const data = item.json;\n  // type\n  const msgtypeMap = { md: 'markdown' };\n  data.msgtype = msgtypeMap[data.msgtype] || data.msgtype;\n\n  // åç§°\n  let name = data.name || $workflow.name.replaceAll('sub-','');\n  // çŠ¶æ€\n  let state = data.state || 'ğŸ’¬';\n  switch (state) {\n    case 'å¤±è´¥':\n    case 'é”™è¯¯':\n      state = state+'âŒ';\n      break;\n    case 'æˆåŠŸ':\n    case 'å®Œæˆ':\n      state = state+'âœ…';\n      break;\n  }\n  \n  // æ¶ˆæ¯å¤´\n  const msgHeader  = `${name}: ${state} - n8n Automation Notify\\n\\n`Â  \n  \n  if (!data.sessionWebhook) {\n    // å†…å®¹ \n    data.content = msgHeader + data.content;\n  }\n  data.title = data.title || '';\n  return { json: data };\n});\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -192,
        128
      ],
      "id": "a0dee420-3206-4cf1-80cb-0aecb48c86d9",
      "name": "æœºå™¨äººå…³é”®è¯å¤„ç†"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "={{ $json.sessionWebhook }}",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"msgtype\": \"{{$json.msgtype}}\",\n  \"text\": {\n        \"content\": {{$json.content.toJsonString()}}\n  },\n  \"markdown\": {\n         \"title\": \"{{$json.title}}\",\n         \"text\": {{$json.content.toJsonString()}}\n  }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        256,
        224
      ],
      "id": "7faa5e3a-355c-4310-8b2f-a5806a155aa2",
      "name": "é’‰é’‰webhook",
      "retryOnFail": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "mode": "expression",
        "numberOutputs": 2,
        "output": "={{ !$json.sessionWebhook ? 0:1 }}"
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        32,
        128
      ],
      "id": "ca5e62f4-db75-4c65-bf90-4a97fd6044bc",
      "name": "åˆ¤æ–­sessionWebhook"
    }
  ],
  "pinData": {
    "å­æµç¨‹å…¥å£": [
      {
        "json": {
          "msgtype": "text",
          "sessionWebhook": "https://oapi.dingtalk.com/robot/sendBySession?session=efefbd8815ee1205506d5f50910c2b3c",
          "content": "å—¯ï¼Œä½ è¯´åˆ°â€œå›½é™…åŒ–â€ï¼Œæ˜¯æƒ³äº†è§£ä»€ä¹ˆå‘¢ï¼Ÿ\n\n*   ä½ æ˜¯æƒ³é—®æˆ‘æ˜¯å¦æ”¯æŒå¤šç§è¯­è¨€å—ï¼Ÿ\n*   è¿˜æ˜¯æƒ³è®¨è®ºå…³äºå›½é™…åŒ–çš„è¯é¢˜ï¼Ÿ\n*   æˆ–è€…æœ‰ä»€ä¹ˆå…·ä½“çš„é—®é¢˜éœ€è¦æˆ‘å¸®å¿™è§£ç­”ï¼Ÿ\n\nè¯·å‘Šè¯‰æˆ‘æ›´å¤šç»†èŠ‚ï¼Œæˆ‘æ‰èƒ½æ›´å¥½åœ°å¸®åŠ©ä½ å“¦ï¼ğŸ˜Š",
          "title": null,
          "name": null,
          "state": null
        }
      }
    ]
  },
  "settings": {
    "executionOrder": "v1",
    "timezone": "Asia/Shanghai",
    "callerPolicy": "workflowsFromSameOwner"
  },
  "shared": [
    {
      "createdAt": "2025-06-27T04:05:59.496Z",
      "updatedAt": "2025-06-27T04:05:59.496Z",
      "role": "workflow:owner",
      "workflowId": "4tHTAEVO9ryUxOhn",
      "projectId": "BeX3bor8ts20lbDK"
    }
  ],
  "staticData": null,
  "tags": [
    {
      "createdAt": "2025-07-11T02:54:27.831Z",
      "updatedAt": "2025-07-11T03:55:43.484Z",
      "id": "JqrpOsXNCY5fMnlD",
      "name": "Common"
    }
  ],
  "triggerCount": 0,
  "updatedAt": "2025-09-12T06:09:37.000Z",
  "versionId": "214d64ef-5ede-4abd-99f3-d3de74a3986d"
}