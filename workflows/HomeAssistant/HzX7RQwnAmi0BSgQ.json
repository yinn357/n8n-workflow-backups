{
  "active": true,
  "connections": {
    "toMarkdownå†…å®¹": {
      "main": [
        [
          {
            "node": "md-é’‰é’‰é€šçŸ¥",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å®šæ—¶å˜é‡æ—¥å¿—": {
      "main": [
        [
          {
            "node": "æŸ¥è¯¢ä¸´æ—¶è¡¨",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æŸ¥è¯¢ä¸´æ—¶è¡¨": {
      "main": [
        [
          {
            "node": "toMarkdownå†…å®¹",
            "type": "main",
            "index": 0
          },
          {
            "node": "æ¸…ç©ºä¸´æ—¶è¡¨",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ¸…ç©ºä¸´æ—¶è¡¨": {
      "main": [
        []
      ]
    },
    "æŸ¥è¯¢ä¸´æ—¶è¡¨æ¡æ•°": {
      "main": [
        [
          {
            "node": "æ¡æ•°å¤§äº20",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å­æµç¨‹è§¦å‘": {
      "main": [
        [
          {
            "node": "æŸ¥è¯¢ä¸´æ—¶è¡¨æ¡æ•°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ¡æ•°å¤§äº20": {
      "main": [
        [
          {
            "node": "æŸ¥è¯¢ä¸´æ—¶è¡¨",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-08-14T02:48:24.565Z",
  "id": "HzX7RQwnAmi0BSgQ",
  "isArchived": false,
  "meta": null,
  "name": "sub-HAå…¨å±€å˜é‡-å®šæ—¶é€šçŸ¥",
  "nodes": [
    {
      "parameters": {
        "jsCode": "/**\n * å°†æ•°æ®æ•°ç»„è½¬æ¢æˆ Markdown Table æ ¼å¼\n */\nfunction toMarkdownTable(jsonArray, ignoreFields = []) {\n  const headers = Object.keys(jsonArray[0].json).filter(h => !ignoreFields.includes(h));\n  const headerRow = '| ' + headers.join(' | ') + ' |';\n  const separatorRow = '| ' + headers.map(() => '---').join(' | ') + ' |';\n\n  const dataRows = jsonArray.map(obj =>\n    '| ' + headers.map(h => String(obj.json[h]).replace(/\\|/g, '\\\\|')).join(' | ') + ' |'\n  );\n\n  return [headerRow, separatorRow, ...dataRows].join('\\n');\n}\nconst ignoreFields = ['æºæ•°æ®', '_id', 'id', 'keys'];\nlet tableMd = toMarkdownTable($input.all(), ignoreFields);\n\n/**\n * å°†æ•°æ®æ•°ç»„è½¬æ¢æˆ Markdown å½¢å¼ï¼š\n * ### HH:MM\n * - äºº: x    ç¯: y    å™¨: z\n */\nfunction toSimpleMd(data) {\n  return data.map(item => {\n    const json = item.json\n    // æˆªå–æ—¶é—´ä¸­çš„æ—¶:åˆ†\n    const hhmm = json['æ—¶é—´']?.slice(11, 16);\n    const people = json['æœ‰äºº'];\n    const lamps  = json['ç¯å…‰æ•°é‡'];\n    const devices= json['å®¶ç”µæ•°é‡'];\n    // return `### ${hhmm}\\n- äºº: ${people}\\tç¯: ${lamps}\\tå™¨: ${devices}`;\n    return `- ğŸ•¦${hhmm} ğŸ§â€${people} ğŸ’¡${lamps} ğŸ”Œ${devices}`;\n    \n  }).join('\\n');\n}\n\nlet listMd = toSimpleMd($input.all());\nreturn [{\n  json:{tableMd,listMd}\n}]"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        768,
        -112
      ],
      "id": "e195b2e8-1d01-42ff-b629-2d84f55f0757",
      "name": "toMarkdownå†…å®¹"
    },
    {
      "parameters": {
        "workflowId": {
          "__rl": true,
          "value": "4tHTAEVO9ryUxOhn",
          "mode": "list",
          "cachedResultName": "sub-é’‰é’‰é€šçŸ¥"
        },
        "workflowInputs": {
          "mappingMode": "defineBelow",
          "value": {
            "msgtype": "md",
            "content": "={{ $json.listMd }}",
            "title": "ç±³å®¶å˜é‡è®°å½•",
            "name": "ç±³å®¶å˜é‡è®°å½•"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "msgtype",
              "displayName": "msgtype",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "content",
              "displayName": "content",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "title",
              "displayName": "title",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "name",
              "displayName": "name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            },
            {
              "id": "state",
              "displayName": "state",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "canBeUsedToMatch": true,
              "type": "string"
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": true
        },
        "options": {}
      },
      "type": "n8n-nodes-base.executeWorkflow",
      "typeVersion": 1.2,
      "position": [
        992,
        -112
      ],
      "id": "9b983ebc-412e-4454-aba5-1c3236ed5da8",
      "name": "md-é’‰é’‰é€šçŸ¥"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "cronExpression",
              "expression": "55 55 8,19 * * *"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        320,
        -112
      ],
      "id": "827a3468-f7cc-4040-96c2-446c29addebf",
      "name": "å®šæ—¶å˜é‡æ—¥å¿—"
    },
    {
      "parameters": {
        "db_path": "=/files/database/home-assistant.db",
        "query_type": "SELECT",
        "query": "SELECT * FROM global_variables_temp",
        "spread": true
      },
      "type": "n8n-nodes-sqlite3.sqliteNode",
      "typeVersion": 1,
      "position": [
        544,
        -208
      ],
      "id": "29d18ef5-f867-498b-ba25-eb06365b4878",
      "name": "æŸ¥è¯¢ä¸´æ—¶è¡¨",
      "executeOnce": false
    },
    {
      "parameters": {
        "db_path": "=/files/database/home-assistant.db",
        "query_type": "DELETE",
        "query": "DELETE FROM global_variables_temp"
      },
      "type": "n8n-nodes-sqlite3.sqliteNode",
      "typeVersion": 1,
      "position": [
        768,
        -304
      ],
      "id": "a8bf38e7-8907-4588-9384-db23bc3ac1d5",
      "name": "æ¸…ç©ºä¸´æ—¶è¡¨",
      "executeOnce": true
    },
    {
      "parameters": {
        "db_path": "/files/database/home-assistant.db",
        "query_type": "SELECT",
        "query": "select COUNT(1) num from global_variables_temp",
        "spread": true
      },
      "type": "n8n-nodes-sqlite3.sqliteNode",
      "typeVersion": 1,
      "position": [
        96,
        -304
      ],
      "id": "83221407-6066-4267-be16-47ceecb23391",
      "name": "æŸ¥è¯¢ä¸´æ—¶è¡¨æ¡æ•°",
      "executeOnce": true
    },
    {
      "parameters": {
        "inputSource": "passthrough"
      },
      "type": "n8n-nodes-base.executeWorkflowTrigger",
      "typeVersion": 1.1,
      "position": [
        -128,
        -304
      ],
      "id": "b7973840-ff97-4285-aac4-e31c5d14b223",
      "name": "å­æµç¨‹è§¦å‘",
      "disabled": true
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "27f5f618-1239-429f-95a3-39e06187592f",
              "leftValue": "={{ $json.num }}",
              "rightValue": 20,
              "operator": {
                "type": "number",
                "operation": "gte"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        320,
        -304
      ],
      "id": "3d42af4a-4dda-4c33-93a7-9abe750941ef",
      "name": "æ¡æ•°å¤§äº20"
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1",
    "callerPolicy": "workflowsFromSameOwner",
    "errorWorkflow": "vI7EThg6H9bW1f4v"
  },
  "shared": [
    {
      "updatedAt": "2025-08-14T02:48:24.586Z",
      "createdAt": "2025-08-14T02:48:24.586Z",
      "role": "workflow:owner",
      "workflowId": "HzX7RQwnAmi0BSgQ",
      "projectId": "BeX3bor8ts20lbDK"
    }
  ],
  "staticData": {
    "node:å®šæ—¶å˜é‡æ—¥å¿—": {
      "recurrenceRules": [
        8
      ]
    },
    "node:Schedule Trigger": {
      "recurrenceRules": []
    },
    "node:å®šæ—¶10åˆ†é’Ÿ": {
      "recurrenceRules": []
    }
  },
  "tags": [
    {
      "updatedAt": "2025-09-10T02:08:30.393Z",
      "createdAt": "2025-06-26T06:14:33.448Z",
      "id": "FHV017iDd8qf8jAL",
      "name": "HomeAssistant"
    }
  ],
  "triggerCount": 1,
  "updatedAt": "2025-12-01T03:52:03.000Z",
  "versionId": "b902fa60-3624-4997-a819-0f4bb406d886"
}